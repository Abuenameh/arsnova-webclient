<div fxLayout="row" fxLayoutGap="20px" fxLayoutAlign="center">
  <mat-card>
    <div fxLayout="row" fxLayoutAlign="start center">
      <div class="cardTitle">
        <h2 *ngIf="!creationMode">{{ 'content.loose-contents' | translate }}</h2>
        <mat-form-field *ngIf="creationMode">
          <input matInput maxlength="25" [(ngModel)]="newName">
          <mat-placeholder>{{ 'content.content-group-name' | translate }}</mat-placeholder>
        </mat-form-field>
      </div>
      <span class="fill-remaining-space"></span>
      <div fxLayoutGap="15px">
        <button *ngIf="creationMode" mat-raised-button class="button-abort" (click)="exitCreation()">
          {{ 'content.cancel' | translate }}
        </button>
        <button mat-raised-button class="button-primary" (click)="createNewGroup()">
          {{ ( creationMode ? 'content.create' : 'content.create-group-with-loose-contents') | translate }}
        </button>
      </div>
    </div>
    <mat-card-content>
      <p>{{ 'content.loose-contents-description' | translate }}</p>
      <app-loading-indicator *ngIf="isLoading" [size]="50"></app-loading-indicator>
      <mat-expansion-panel *ngFor="let content of contents; index as i" class="matPanel">
        <mat-expansion-panel-header class="matPanelListHeader">
          <mat-panel-title class="panelTitle">
            <mat-checkbox *ngIf="creationMode" (click)="$event.stopPropagation()" [(ngModel)]="creationSelection[i]">
            </mat-checkbox>
            {{ labels[i] }}
          </mat-panel-title>
          <button mat-icon-button [matMenuTriggerFor]="moreActions" (click)="$event.stopPropagation()"
                  class="editButton" matTooltip="{{ 'content.more-options' | translate}}">
            <mat-icon>more_vert</mat-icon>
          </button>

          <mat-menu #moreActions="matMenu" xPosition="before">
            <button mat-menu-item (click)="editContent(content)">
              <mat-icon>edit</mat-icon>
              <span> {{ 'content.edit-content' | translate}}</span>
          </button>
            <button mat-menu-item [matMenuTriggerFor]="chooseGroups">
              <mat-icon>library_add</mat-icon>
              <span>{{ 'content.add-content-to-group' | translate}}</span>
            </button>
            <button mat-menu-item (click)="deleteContent(content)">
              <mat-icon class="delete">delete_forever</mat-icon>
              <span>{{ 'content.delete-content' | translate}}</span>
            </button>
          </mat-menu>

          <mat-menu #chooseGroups="matMenu" xPosition="before">
            <button mat-menu-item *ngFor="let cg of contentGroups; index as i" [disabled]="i === currentGroupIndex"
                    (click)="addToContentGroup(content.id, cg, false)">
              <span>{{ cg }}</span>
            </button>
            <mat-divider></mat-divider>
            <button mat-menu-item (click)="showContentGroupCreationDialog(content.id)">
              <mat-icon>add</mat-icon>
              <span>{{ 'content.new-content-group' | translate}}</span>
            </button>
          </mat-menu>

        </mat-expansion-panel-header>
        <mat-panel-description class="panelTitle">
          {{ content.body }}
        </mat-panel-description>
      </mat-expansion-panel>
    </mat-card-content>
  </mat-card>
</div>
